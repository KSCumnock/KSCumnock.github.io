<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holiday Management</title>
    <link href="style.css" rel="stylesheet"/>
</head>

<body>
    <div class="container">
       <div class="header">
    <h1>üèñÔ∏è Holiday Management System</h1>
    <p>Manage employee holiday requests and allowances</p>
    
    <!-- Add this year selector section -->
    <div class="year-selector">
        <label for="year-select">Select Year:</label>
        <select id="year-select" onchange="changeYear()">
            <option value="2025">2025</option>
            <option value="2026">2026</option>
            <option value="2027">2027</option>
             <option value="2028">2028</option>
              <option value="2029">2029</option>
               <option value="2030">2030</option>
        </select>
        <span id="current-year-display">Current: 2025</span>
    </div>
</div>

        
        <div class="tab-container">
            <button class="tab active" onclick="showTab('employee')">Employee Portal</button>
            <button class="tab" onclick="showTab('calendar')">Calendar View</button>
            <button class="tab" onclick="showTab('analytics')">Analytics</button>
            <button class="tab" onclick="showTab('admin')">
                Admin Panel
                <span id="admin-notification-badge" class="notification-badge hidden">0</span>
            </button>
        </div>
        
        <!-- Employee Portal -->
        <div id="employee-tab" class="content">
            <div class="loading" id="employee-loading">Loading employees...</div>
            <div id="employee-error" class="error hidden"></div>
            
            <div id="employee-content" class="hidden">
                <h3 style="margin-bottom: 20px; color: #333; font-weight: 500;">Select Employee</h3>

                <!-- Search input -->
                <div style="margin-bottom: 20px;">
                    <input type="text" id="employee-search" placeholder="Search employees..." oninput="filterEmployeeCards()" style="padding: 10px; width: 100%; font-size: 16px; border: 2px solid #e9ecef; border-radius: 8px;">
                </div>

                <div id="employee-cards" class="employee-cards-grid"></div>
                
                <div id="employee-info" class="hidden">
                    <div class="allowance-info">
                      <h3 style="margin: 0 0 10px 0; font-weight: 500;">
  Holiday Allowance for <span id="employee-name" style="font-weight: 600;">[Employee Name]</span>
</h3>
<p style="margin: 0; font-size: 16px;">
  <span id="remaining-days">0</span> days remaining out of <span id="total-days">0</span> total days
</p>

                    </div>
                    
                    <form id="holiday-form" onsubmit="submitHolidayRequest(event)">
                        <div class="grid">
                            <div>
                                <!-- Request Type Selection -->
                                <div class="form-group">
                                    <label for="request-type">Request Type:</label>
                                    <select id="request-type" required onchange="updateRequestTypeOptions()">
                                        <option value="holiday">Holiday</option>
                                        <option value="sick">Sick Leave</option>
                                        <option value="bereavement">Bereavement Leave</option>
                                    </select>
                                </div>
                                
                                <!-- Date Range Inputs -->
                                <div id="date-range-inputs">
                                    <div class="form-group">
                                        <label for="start-date">Start Date:</label>
                                        <input type="date" id="start-date" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="end-date">End Date:</label>
                                        <input type="date" id="end-date" required>
                                    </div>
                                </div>
                                
                                <!-- Block Booking Calendar -->
                                <div id="block-booking-calendar" class="hidden">
                                    <div class="form-group">
                                        <label>Select Dates (click to select/deselect):</label>
                                        <div class="block-calendar-container">
                                            <div class="block-calendar-header">
                                                <button type="button" class="calendar-nav" onclick="changeBlockMonth(-1)">‚ùÆ</button>
                                                <h4 id="block-calendar-title"></h4>
                                                <button type="button" class="calendar-nav" onclick="changeBlockMonth(1)">‚ùØ</button>
                                            </div>
                                            <div class="block-calendar-grid" id="block-calendar-grid"></div>
                                        </div>
                                        <div id="selected-dates-summary" class="selected-dates-summary hidden">
                                            <h5>Selected Dates:</h5>
                                            <div id="selected-dates-list"></div>
                                            <div id="booking-groups-preview" class="booking-groups-preview"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Block Booking Toggle -->
                                <div class="form-group">
                                    <div class="half-day-container">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="block-booking-toggle" onchange="toggleBlockBooking()">
                                            <span class="checkbox-custom"></span>
                                            Block Booking (Select multiple dates)
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="half-day-container">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="half-day-toggle" onchange="toggleHalfDay()">
                                            <span class="checkbox-custom"></span>
                                            Half Day Request
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group hidden" id="half-day-options">
                                    <label for="half-day-period">Time Period:</label>
                                    <select id="half-day-period">
                                        <option value="morning">Morning (AM)</option>
                                        <option value="afternoon">Afternoon (PM)</option>
                                    </select>
                                </div>
                                
                                <!-- Deduct from Holiday Allowance Toggle -->
                                <div class="form-group" id="deduct-toggle-container" style="display: none;">
                                    <div class="half-day-container">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="deduct-from-holiday" onchange="updateDaysPreview()">
                                            <span class="checkbox-custom"></span>
                                            Deduct from Holiday Allowance
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <div class="form-group">
                                    <label for="reason">Reason (optional):</label>
                                    <textarea id="reason" rows="4" placeholder="Family vacation, medical appointment, etc."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <div class="days-calculator" id="days-preview">
                                        <strong>Days to be deducted from holiday allowance:</strong> <span id="calculated-days">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit">Submit Request</button>
                    </form>
                    
                    <h3 style="margin: 40px 0 20px 0; color: #333; font-weight: 500;">Your Requests</h3>
                    <div id="employee-requests"></div>
                </div>
            </div>
        </div>
        
        <!-- Calendar View -->
        <div id="calendar-tab" class="content hidden">
            <div class="calendar-container">
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="changeMonth(-1)">‚ùÆ</button>
                    <h3 id="calendar-title"></h3>
                    <button class="calendar-nav" onclick="changeMonth(1)">‚ùØ</button>
                </div>
                <div class="calendar-grid" id="calendar-grid"></div>
            </div>
            <p style="color: #6c757d; text-align: center; margin-top: 10px;">
                üí° Click on dates with employee names to see detailed information
            </p>
        </div>
        
        <!-- Analytics Tab -->
        <div id="analytics-tab" class="content hidden">
            <h2 style="margin-bottom: 30px; color: #333;">üìä Holiday Analytics & Insights</h2>
            
            <!-- Year Filter -->
            <div style="margin-bottom: 30px;">
                <label for="analytics-year-select" style="font-weight: 500; margin-right: 10px;">Reporting Year:</label>
                <select id="analytics-year-select" onchange="refreshAnalytics()" style="padding: 8px 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px;">
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <option value="2025" selected>2025</option>
                    <option value="2026">2026</option>
                </select>
            </div>
            
            <!-- Key Metrics Overview -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">Total Days Taken</div>
                    <div id="analytics-total-days" style="font-size: 32px; font-weight: 700;">0</div>
                </div>
                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">Avg Days Per Employee</div>
                    <div id="analytics-avg-days" style="font-size: 32px; font-weight: 700;">0</div>
                </div>
                <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">Total Requests</div>
                    <div id="analytics-total-requests" style="font-size: 32px; font-weight: 700;">0</div>
                </div>
                <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">Approval Rate</div>
                    <div id="analytics-approval-rate" style="font-size: 32px; font-weight: 700;">0%</div>
                </div>
            </div>
            
            <!-- Monthly Usage Trends -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 20px; color: #333;">Monthly Holiday Usage Trends</h3>
                <div id="monthly-chart" style="height: 300px;"></div>
            </div>
            
            <!-- Side by side charts -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 30px; margin-bottom: 30px;">
                <!-- Request Type Breakdown -->
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px; color: #333;">Request Type Distribution</h3>
                    <div id="request-type-chart" style="height: 250px;"></div>
                </div>
                
                <!-- Status Breakdown -->
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px; color: #333;">Request Status Distribution</h3>
                    <div id="status-chart" style="height: 250px;"></div>
                </div>
            </div>
            
            <!-- Team Coverage Heatmap -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 20px; color: #333;">Team Coverage Heatmap (People Available per Day)</h3>
                <div id="coverage-heatmap"></div>
            </div>
            
            <!-- Employee Utilization Ranking -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 20px; color: #333;">Employee Holiday Utilization</h3>
                <div id="employee-utilization"></div>
            </div>
            
            <!-- Busiest Months & Insights -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-bottom: 30px;">
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 15px; color: #333;">üìà Busiest Months</h3>
                    <div id="busiest-months"></div>
                </div>
                
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 15px; color: #333;">üéØ Key Insights</h3>
                    <div id="key-insights"></div>
                </div>
                
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 15px; color: #333;">üîÆ Forecasting</h3>
                    <div id="forecasting"></div>
                </div>
            </div>
            
            <!-- Year Comparison -->
            <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 20px; color: #333;">Year-over-Year Comparison</h3>
                <div id="year-comparison"></div>
            </div>
        </div>
        
        <!-- Admin Panel -->
        <div id="admin-tab" class="content hidden">
            <div class="loading" id="admin-loading">Loading admin data...</div>
            <div id="admin-error" class="error hidden"></div>
            
            <div id="admin-content" class="hidden">
                <!-- Admin Navigation Tabs -->
                <div class="tabs-container">
                    <button class="admin-tab-btn active" onclick="showAdminSection('pending')">Pending Requests</button>
                    <button class="admin-tab-btn" onclick="showAdminSection('employees')">Employee Management</button>
                    <button class="admin-tab-btn" onclick="showAdminSection('all-requests')">All Requests</button>
                    <button class="admin-tab-btn" onclick="showAdminSection('employee-view')">Employee Quick View</button>
                    <button class="admin-tab-btn" onclick="showAdminSection('reports')">üìÑ Reports</button>
                </div>
                
                <!-- Pending Requests Section -->
                <div id="admin-pending" class="admin-section">
                    <h3>üïí Pending Requests</h3>
                    <div id="pending-requests"></div>
                </div>
                
                <!-- Employee Management Section -->
                <div id="admin-employees" class="admin-section hidden">
                    <h3>üë• Employee Management</h3>
                    <div class="compact-grid">
                        <div>
                            <h4>Add New Employee</h4>
                            <form id="add-employee-form" onsubmit="addEmployee(event)">
                                <div class="form-group">
                                    <label for="employee-name">Employee Name:</label>
                             <input type="text" id="new-employee-name" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="employee-allowance">Annual Holiday Allowance:</label>
                                  <input type="number" id="employee-allowance" value="30" min="1" step="0.5" required>
                                </div>

                                  <!-- Add this to the employee management form -->
                                <div class="form-group">
                                    <div class="half-day-container">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="include-saturday-deduction">
                                            <span class="checkbox-custom"></span>
                                            Include Saturday Deduction (Saturday holidays deduct from allowance)
                                        </label>
                                    </div>
                                </div>
                                
                                <button type="submit">Add Employee</button>
                            </form>
                        </div>
                        
                        <div>
                            <h4>Current Employees</h4>
                            <div id="employee-list"></div>
                        </div>
                    </div>
                </div>
                
                <!-- All Requests Section -->
                <div id="admin-all-requests" class="admin-section hidden">
                    <h3>üìã All Requests</h3>
                    <div id="all-requests"></div>
                </div>
                
                <!-- Employee Quick View Section -->
                <div id="admin-employee-view" class="admin-section hidden">
                    <h3>üë§ Employee Quick View</h3>
                    <p style="color: #6c757d; margin-bottom: 15px;">Click on any employee to view their history</p>
                    <div id="employee-quick-view"></div>
                </div>
                
                <!-- Employee Reports Section -->
                <div id="admin-reports" class="admin-section hidden">
                    <h3>üìÑ Employee Reports</h3>
                    <p style="color: #6c757d; margin-bottom: 20px;">Generate detailed reports for individual employees or all employees</p>
                    
                    <div class="compact-grid">
                        <div>
                            <h4>Individual Employee Report</h4>
                            <div class="form-group">
                                <label for="report-employee-select">Select Employee:</label>
                                <select id="report-employee-select">
                                    <option value="">Choose an employee...</option>
                                </select>
                            </div>
                            <button onclick="exportEmployeeReport()" id="export-single-btn" disabled>Export Employee Report</button>
                        </div>
                        
                        <div>
                            <h4>All Employees Report</h4>
                            <p style="font-size: 14px; color: #6c757d; margin-bottom: 15px;">
                                Generate a comprehensive report containing data for all employees.
                            </p>
                            <button onclick="exportAllEmployeesReport()">Export All Employees Report</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- PIN Modal -->
    <div id="pin-modal" class="pin-modal hidden">
        <div class="pin-content">
            <h3>Admin Access Required</h3>
            <p>Please enter the admin PIN:</p>
            <input type="password" id="pin-input" class="pin-input" maxlength="4" placeholder="****">
            <div>
                <button onclick="checkPin()">Enter</button>
                <button onclick="closePinModal()" style="margin-left: 10px; background: #6c757d;">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Employee Detail Modal -->
    <div id="employee-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="employee-modal-title">Employee History</h3>
                <button class="close-btn" onclick="closeEmployeeModal()">√ó</button>
            </div>
            <div id="employee-modal-content"></div>
        </div>
    </div>


 <script src="script.js"></script>

</body>
</html>